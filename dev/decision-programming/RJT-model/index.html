<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>RJT model · DecisionProgramming.jl</title><meta name="title" content="RJT model · DecisionProgramming.jl"/><meta property="og:title" content="RJT model · DecisionProgramming.jl"/><meta property="twitter:title" content="RJT model · DecisionProgramming.jl"/><meta name="description" content="Documentation for DecisionProgramming.jl."/><meta property="og:description" content="Documentation for DecisionProgramming.jl."/><meta property="twitter:description" content="Documentation for DecisionProgramming.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="DecisionProgramming.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DecisionProgramming.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Decision Programming</span><ul><li><a class="tocitem" href="../influence-diagram/">Influence Diagram</a></li><li><a class="tocitem" href="../paths/">Paths</a></li><li><a class="tocitem" href="../decision-model/">Decision Model</a></li><li><a class="tocitem" href="../analyzing-decision-strategies/">Analyzing Decision Strategies</a></li><li><a class="tocitem" href="../computational-complexity/">Computational Complexity</a></li></ul></li><li><a class="tocitem" href="../../usage/">Usage</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/used-car-buyer/">Used Car Buyer</a></li><li><a class="tocitem" href="../../examples/pig-breeding/">Pig Breeding</a></li><li><a class="tocitem" href="../../examples/n-monitoring/">N-Monitoring</a></li><li><a class="tocitem" href="../../examples/contingent-portfolio-programming/">Contingent Portfolio Programming</a></li><li><a class="tocitem" href="../../examples/CHD_preventative_care/">CHD preventative care allocation</a></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>RJT model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>RJT model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gamma-opt/DecisionProgramming.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gamma-opt/DecisionProgramming.jl/blob/master/docs/src/decision-programming/RJT-model.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="RJT-model"><a class="docs-heading-anchor" href="#RJT-model">RJT model</a><a id="RJT-model-1"></a><a class="docs-heading-anchor-permalink" href="#RJT-model" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Influence diagrams can be represented as directed rooted trees composed of clusters, which can be transformed into gradual rooted junction trees (RJTs) by imposing additional constraints. These can then be used to formulate an optimization model. Solving for optimal decision strategies using these formulations can be done with significantly less computing time than for full path based formulations. Using RJT based formulations is thus generally preferable.</p><p>The explanations for RJT construction and RJT based model formulation largely follow that of Herrala et al. (2024). <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><h2 id="Converting-influence-diagrams-to-RJTs"><a class="docs-heading-anchor" href="#Converting-influence-diagrams-to-RJTs">Converting influence diagrams to RJTs</a><a id="Converting-influence-diagrams-to-RJTs-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-influence-diagrams-to-RJTs" title="Permalink"></a></h2><p>An influence diagram <span>$G = (N, A)$</span> can be represented as a directed rooted tree <span>$\mathscr{G} = (\mathscr{V}, \mathscr{A})$</span> composed of <em>clusters</em> <span>$C \isin V$</span>, which are subsets of the nodes of the ID, that is, <span>$C \subset \mathscr{V}$</span>. Both <span>$G$</span> and <span>$\mathscr{G}$</span> are directed acyclic graphs whose vertices are connected with directed arcs in <span>$A$</span> and <span>$\mathscr{A}$</span> , respectively. The main difference between these diagrams lies in the nature of the vertices. In an influence diagram, the set of nodes <span>$N$</span> consists of individual chance events, decisions and consequences, while the clusters in <span>$\mathscr{V}$</span> comprise multiple nodes, hence the notational distinction between <span>$N$</span> and <span>$\mathscr{V}$</span>.</p><p>In order to reformulate this tree into a MIP model, additional constraints need to be imposed, making <span>$\mathscr{G}$</span> a <em>gradual rooted junction tree</em>. A directed rooted tree <span>$\mathscr{G} = (\mathscr{V}, \mathscr{A})$</span> consisting of clusters <span>$C \in \mathscr{V}$</span> of nodes <span>$j \in N$</span> is a gradual rooted junction tree corresponding to the influence diagram <span>$G$</span> if:</p><ol><li>Given two clusters <span>$C_1$</span> and <span>$C_2$</span> in the junction tree, any cluster <span>$C$</span> on the unique undirected path between <span>$C_1$</span> and <span>$C_2$</span> satisfies <span>$C_1 \cap C_2 \subset C$</span>. </li><li>Each cluster <span>$C \in \mathscr{V}$</span> is the root cluster of exactly one node <span>$j \in N$</span> (that is, the root of the subgraph induced by the clusters with node <span>$j$</span>) and all nodes <span>$j \in N$</span> appear in at least one of the clusters.</li><li>For each cluster, <span>$I(j) \in C_j$</span>, where <span>$C_j$</span> is the <em>root cluster</em> of <span>$j \in N$</span>.</li></ol><p>A rooted tree satisfying condition (1) is said to satisfy the <em>running intersection property</em>. This condition is sufficient for making <span>$\mathscr{G}$</span> a rooted junction tree (RJT). In addition, as a consequence of condition (2), we see that a gradual RJT has as many clusters as the original influence diagram has nodes, and each node <span>$j \in N$</span> can be thought as corresponding to one of the clusters <span>$C \in \mathscr{V}$</span>. Because of this, we refer to clusters using the corresponding nodes <span>$j \in N$</span> in the influence diagram as the <em>root cluster</em> of node <span>$j \in N$</span>, which is denoted as <span>$C_j \in \mathscr{V}$</span>.</p><p>An example of influence diagram (upper figure) conversion to RJT (lower figure) for pig breeding problem with <span>$N=4$</span> is shown below.</p><p>&lt;img src=&quot;figures/pig<em>breeding</em>N=4.jpg&quot; width=&quot;400&quot;&gt; &lt;br&gt;</p><p>&lt;img src=&quot;figures/pig<em>breeding</em>rjt_N=4.jpg&quot; width=&quot;330&quot;&gt;</p><h2 id="Formulating-an-optimization-problem-based-on-gradual-RJT"><a class="docs-heading-anchor" href="#Formulating-an-optimization-problem-based-on-gradual-RJT">Formulating an optimization problem based on gradual RJT</a><a id="Formulating-an-optimization-problem-based-on-gradual-RJT-1"></a><a class="docs-heading-anchor-permalink" href="#Formulating-an-optimization-problem-based-on-gradual-RJT" title="Permalink"></a></h2><p>Formulating an optimization model based on the gradual RJT representation starts by introducing a vector of moments <span>$\mu_{C_j}$</span> for each cluster <span>$C_j, \ j \in N$</span>. Parmentier et al. (2020) <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> show that for RJTs, we can impose constraints so that these become moments of a distribution <span>$\mu_N$</span> that factorizes according to <span>$G(N,A)$</span>. The joint distribution <span>$\mathbb{P}$</span> is said to factorize <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> according to <span>$G$</span> if <span>$\mathbb{P}$</span> can be expressed as </p><p class="math-container">\[\mathbb{P}(X_N = s_N) = \prod_{j \in N}\mathbb{P}(X_j=s_j \mid X_{I(j)}=s_{I(j)}).\tag{1}\]</p><p>In the formulation, <span>$\mu_{C_j}(s_{C_j})$</span> represents the probability of the nodes within the cluster <span>$C_j$</span> being in states <span>$s_{C_j}$</span> and condition (3) of definition above ensures that <span>$\mathbb{P}(X_j=s_j \mid X_{I(j)}=s_{I(j)})$</span> can thus be obtained from <span>$\mu_{C_j}(s_{C_j})$</span> for each <span>$j \in N$</span>.</p><p>Variable definitions are given in the influence diagram section.</p><h2 id="MIP-model-formulation"><a class="docs-heading-anchor" href="#MIP-model-formulation">MIP model formulation</a><a id="MIP-model-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#MIP-model-formulation" title="Permalink"></a></h2><h3 id="Objective-function"><a class="docs-heading-anchor" href="#Objective-function">Objective function</a><a id="Objective-function-1"></a><a class="docs-heading-anchor-permalink" href="#Objective-function" title="Permalink"></a></h3><p>Based on the observations above, the MIP model can be formulated. The objective function becomes:</p><p class="math-container">\[{\text{maximize}} \sum_{j \in N^V} \sum_{s_{C_j} \in S_{C_j}} \mu_{C_j}(s_{C_j}) u_{C_j}(s_{C_j})\tag{2}\]</p><p>This represents an expected utility maximization problem where <span>$u_{C_j}$</span> represent the utility values associated with different realizations of the nodes within the cluster <span>$C_j$</span>.</p><h3 id="Constraints"><a class="docs-heading-anchor" href="#Constraints">Constraints</a><a id="Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Constraints" title="Permalink"></a></h3><h4 id="Decision-variables"><a class="docs-heading-anchor" href="#Decision-variables">Decision variables</a><a id="Decision-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Decision-variables" title="Permalink"></a></h4><p>Only one positive decision can be taken given the same information:</p><p class="math-container">\[\sum_{s_j \in S_{I(j)}}\delta (s_j \mid s_{I(j)})=1, \ \forall j \in N^D, s_{I(j)} \in S_{I(j)}\tag{3}\]</p><h4 id="μ-variables"><a class="docs-heading-anchor" href="#μ-variables">μ-variables</a><a id="μ-variables-1"></a><a class="docs-heading-anchor-permalink" href="#μ-variables" title="Permalink"></a></h4><p>μ-variables need to represent valid probability distributions with probabilities summing up to 1. Thus, we get constraint:</p><p class="math-container">\[\sum_{s_{C_j} \in S_{C_j}} \mu_{C_j}(s_{C_j}) = 1, \ \forall j \in N\\\tag{3}\]</p><p>We use moments <span>$\mu_{\overline{C}_j}$</span> (μ_bar in the code) to ease the notation. These are defined as</p><p class="math-container">\[\mu_{\overline{C}_j}(s_{\overline{C}_j}) = \sum_{s_j \in S_j} \mu_{C_j}(s_{C_j})\tag{4}\]</p><p>representing the marginal distribution for cluster <span>$C_j$</span> with the node <span>$j$</span> marginalized out. <span>$\overline{C}_j = C_j \setminus j$</span> is used for notational brevity.</p><h4 id="Local-consistency"><a class="docs-heading-anchor" href="#Local-consistency">Local consistency</a><a id="Local-consistency-1"></a><a class="docs-heading-anchor-permalink" href="#Local-consistency" title="Permalink"></a></h4><p>The following constraint enforces local consistency between adjacent clusters, meaning that for a pair <span>$C_i, C_j$</span> of adjacent clusters, the marginal distribution for the nodes in both <span>$C_i$</span> and <span>$C_j$</span> (that is, <span>$C_i \cap C_j$</span>) must be the same when obtained from either <span>$C_i$</span> or <span>$C_j$</span>. This is formulated as:</p><p class="math-container">\[\sum_{\substack{s_{C_i} \in S_{C_i}, \\ s_{C_i \cap C_j} = s^*_{C_i \cap C_j}}} \mu_{C_i}(s_{C_i})= \sum_{\substack{s_{C_j} \in S_{C_j}, \\ s_{C_i \cap C_j} = s^*_{C_i \cap C_j}}} \mu_{C_j}(s_{C_j}),  \nonumber\\ \tag{5}\]</p><p class="math-container">\[\qquad\qquad\qquad\qquad  \ \forall (C_i,C_j) \in \mathscr{A}, s^*_{C_i \cap C_j} \in S_{C_i \cap C_j}\\\]</p><h4 id="Conditional-probabilities-and-decision-strategies"><a class="docs-heading-anchor" href="#Conditional-probabilities-and-decision-strategies">Conditional probabilities and decision strategies</a><a id="Conditional-probabilities-and-decision-strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-probabilities-and-decision-strategies" title="Permalink"></a></h4><p>Moments <span>$\mu_{\overline{C}_j}$</span> defined above are used here. We get constraints:</p><p class="math-container">\[\mu_{C_j}(s_{C_j}) = \mu_{\overline{C}_j}(s_{\overline{C}_j}) p(s_j \mid s_{I(j)}), \ \forall j \in N^C \cup N^V, s_{C_j} \in S_{C_j} \tag{6}\\\]</p><p class="math-container">\[\mu_{C_j}(s_{C_j}) \le \delta(s_j \mid s_{I(j)}), \ \forall j \in N^D, s_{C_j} \in S_{C_j} \tag{7}\\\]</p><p>The value <span>$p(s_j \mid s_{I(j)})$</span> is the conditional probability of a state <span>$s_j$</span> given the information state <span>$s_{I(j)}$</span> and <span>$\delta(s_j \mid s_{I(j)})$</span> the decision strategy in node <span>$j \in N^D$</span>.</p><h4 id="Non-negativity-and-integer-constraints"><a class="docs-heading-anchor" href="#Non-negativity-and-integer-constraints">Non-negativity and integer constraints</a><a id="Non-negativity-and-integer-constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Non-negativity-and-integer-constraints" title="Permalink"></a></h4><p>All probability and decision variables have to be non-negative. Decision variables are binary.</p><p class="math-container">\[\mu_{C_j}(s_{C_j}) \ge 0, \ \forall j \in N, s_{C_j} \in S_{C_j}\tag{8}\]</p><p class="math-container">\[\delta(s_j \mid s_{I(j)}) \in \{0,1\}, \ \forall j \in N^D, s_j \in S_j, s_{I(j)} \in S_{I(j)}\tag{9}\]</p><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><p>Currently, the RJT formulation commands in the package do not support forbidden path or fixed path features.</p><h2 id="Computational-considerations"><a class="docs-heading-anchor" href="#Computational-considerations">Computational considerations</a><a id="Computational-considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Computational-considerations" title="Permalink"></a></h2><p>Around 2-3 magnitudes faster solving times are expected using RJT formulations. <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> In problems with small treewidths, such as the pig breeding problem, the solution times hardly even change when increasing the number of nodes.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Integer programming on the junction tree polytope for influence diagrams. INFORMS Journal on Optimization 2, 209–228.</p><p>and techniques. MIT press</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Herrala, O., Terho, T., Oliveira, F., 2024. Risk-averse decision strategies for influence diagrams using rooted junction trees. Retrieved from [https://arxiv.org/abs/2401.03734]</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Parmentier, A., Cohen, V., Leclere, V., Obozinski, G., Salmon, J., 2020. `</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Koller, D., Friedman, N., 2009. Probabilistic graphical models: principles</li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Tuesday 27 August 2024 12:17">Tuesday 27 August 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
